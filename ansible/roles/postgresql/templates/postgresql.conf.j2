# PostgreSQL configuration file

# Connection settings
listen_addresses = '{{ postgresql_listen_addresses | default("localhost") }}'
port = {{ postgresql_port | default(5432) }}
max_connections = {{ postgresql_max_connections | default(100) }}

# Memory settings
shared_buffers = {{ postgresql_shared_buffers | default("256MB") }}
effective_cache_size = {{ postgresql_effective_cache_size | default("1GB") }}
work_mem = {{ postgresql_work_mem | default("4MB") }}
maintenance_work_mem = {{ postgresql_maintenance_work_mem | default("64MB") }}

# Logging settings
{% if postgresql_log_connections | default(false) %}
log_connections = on
{% else %}
log_connections = off
{% endif %}

{% if postgresql_log_disconnections | default(false) %}
log_disconnections = on
{% else %}
log_disconnections = off
{% endif %}

# SSL settings
{% if postgresql_ssl | default(false) %}
ssl = on
ssl_cert_file = 'server.crt'
ssl_key_file = 'server.key'
{% else %}
ssl = off
{% endif %}

# Write Ahead Logging
wal_level = replica
max_wal_senders = 3
wal_keep_size = 16

# Checkpoint settings
checkpoint_completion_target = 0.9